{"ast":null,"code":"import * as React from 'react';\nimport { getWindow, isElement, isHTMLElement } from '@floating-ui/utils/dom';\nimport { isMac, isSafari } from '@base-ui-components/utils/detectBrowser';\nimport { useTimeout } from '@base-ui-components/utils/useTimeout';\nimport { activeElement, contains, getDocument, getTarget, isTypeableElement, matchesFocusVisible } from \"../utils.js\";\nimport { createChangeEventDetails } from \"../../utils/createBaseUIEventDetails.js\";\nimport { createAttribute } from \"../utils/createAttribute.js\";\nconst isMacSafari = isMac && isSafari;\n/**\n * Opens the floating element while the reference element has focus, like CSS\n * `:focus`.\n * @see https://floating-ui.com/docs/useFocus\n */\nexport function useFocus(context, props = {}) {\n  const {\n    open,\n    onOpenChange,\n    events,\n    dataRef,\n    elements\n  } = context;\n  const {\n    enabled = true,\n    visibleOnly = true\n  } = props;\n  const blockFocusRef = React.useRef(false);\n  const timeout = useTimeout();\n  const keyboardModalityRef = React.useRef(true);\n  React.useEffect(() => {\n    if (!enabled) {\n      return undefined;\n    }\n    const win = getWindow(elements.domReference);\n\n    // If the reference was focused and the user left the tab/window, and the\n    // floating element was not open, the focus should be blocked when they\n    // return to the tab/window.\n    function onBlur() {\n      if (!open && isHTMLElement(elements.domReference) && elements.domReference === activeElement(getDocument(elements.domReference))) {\n        blockFocusRef.current = true;\n      }\n    }\n    function onKeyDown() {\n      keyboardModalityRef.current = true;\n    }\n    function onPointerDown() {\n      keyboardModalityRef.current = false;\n    }\n    win.addEventListener('blur', onBlur);\n    if (isMacSafari) {\n      win.addEventListener('keydown', onKeyDown, true);\n      win.addEventListener('pointerdown', onPointerDown, true);\n    }\n    return () => {\n      win.removeEventListener('blur', onBlur);\n      if (isMacSafari) {\n        win.removeEventListener('keydown', onKeyDown, true);\n        win.removeEventListener('pointerdown', onPointerDown, true);\n      }\n    };\n  }, [elements.domReference, open, enabled]);\n  React.useEffect(() => {\n    if (!enabled) {\n      return undefined;\n    }\n    function onOpenChangeLocal(details) {\n      if (details.reason === 'trigger-press' || details.reason === 'escape-key') {\n        blockFocusRef.current = true;\n      }\n    }\n    events.on('openchange', onOpenChangeLocal);\n    return () => {\n      events.off('openchange', onOpenChangeLocal);\n    };\n  }, [events, enabled]);\n  const reference = React.useMemo(() => ({\n    onMouseLeave() {\n      blockFocusRef.current = false;\n    },\n    onFocus(event) {\n      if (blockFocusRef.current) {\n        return;\n      }\n      const target = getTarget(event.nativeEvent);\n      if (visibleOnly && isElement(target)) {\n        // Safari fails to match `:focus-visible` if focus was initially\n        // outside the document.\n        if (isMacSafari && !event.relatedTarget) {\n          if (!keyboardModalityRef.current && !isTypeableElement(target)) {\n            return;\n          }\n        } else if (!matchesFocusVisible(target)) {\n          return;\n        }\n      }\n      onOpenChange(true, createChangeEventDetails('trigger-focus', event.nativeEvent));\n    },\n    onBlur(event) {\n      blockFocusRef.current = false;\n      const relatedTarget = event.relatedTarget;\n      const nativeEvent = event.nativeEvent;\n\n      // Hit the non-modal focus management portal guard. Focus will be\n      // moved into the floating element immediately after.\n      const movedToFocusGuard = isElement(relatedTarget) && relatedTarget.hasAttribute(createAttribute('focus-guard')) && relatedTarget.getAttribute('data-type') === 'outside';\n\n      // Wait for the window blur listener to fire.\n      timeout.start(0, () => {\n        const activeEl = activeElement(elements.domReference ? elements.domReference.ownerDocument : document);\n\n        // Focus left the page, keep it open.\n        if (!relatedTarget && activeEl === elements.domReference) {\n          return;\n        }\n\n        // When focusing the reference element (e.g. regular click), then\n        // clicking into the floating element, prevent it from hiding.\n        // Note: it must be focusable, e.g. `tabindex=\"-1\"`.\n        // We can not rely on relatedTarget to point to the correct element\n        // as it will only point to the shadow host of the newly focused element\n        // and not the element that actually has received focus if it is located\n        // inside a shadow root.\n        if (contains(dataRef.current.floatingContext?.refs.floating.current, activeEl) || contains(elements.domReference, activeEl) || movedToFocusGuard) {\n          return;\n        }\n        onOpenChange(false, createChangeEventDetails('trigger-focus', nativeEvent));\n      });\n    }\n  }), [dataRef, elements.domReference, onOpenChange, visibleOnly, timeout]);\n  return React.useMemo(() => enabled ? {\n    reference\n  } : {}, [enabled, reference]);\n}","map":{"version":3,"names":["React","getWindow","isElement","isHTMLElement","isMac","isSafari","useTimeout","activeElement","contains","getDocument","getTarget","isTypeableElement","matchesFocusVisible","createChangeEventDetails","createAttribute","isMacSafari","useFocus","context","props","open","onOpenChange","events","dataRef","elements","enabled","visibleOnly","blockFocusRef","useRef","timeout","keyboardModalityRef","useEffect","undefined","win","domReference","onBlur","current","onKeyDown","onPointerDown","addEventListener","removeEventListener","onOpenChangeLocal","details","reason","on","off","reference","useMemo","onMouseLeave","onFocus","event","target","nativeEvent","relatedTarget","movedToFocusGuard","hasAttribute","getAttribute","start","activeEl","ownerDocument","document","floatingContext","refs","floating"],"sources":["C:/Users/james/Documents/DermaScan/adminui/node_modules/@base-ui-components/react/esm/floating-ui-react/hooks/useFocus.js"],"sourcesContent":["import * as React from 'react';\nimport { getWindow, isElement, isHTMLElement } from '@floating-ui/utils/dom';\nimport { isMac, isSafari } from '@base-ui-components/utils/detectBrowser';\nimport { useTimeout } from '@base-ui-components/utils/useTimeout';\nimport { activeElement, contains, getDocument, getTarget, isTypeableElement, matchesFocusVisible } from \"../utils.js\";\nimport { createChangeEventDetails } from \"../../utils/createBaseUIEventDetails.js\";\nimport { createAttribute } from \"../utils/createAttribute.js\";\nconst isMacSafari = isMac && isSafari;\n/**\n * Opens the floating element while the reference element has focus, like CSS\n * `:focus`.\n * @see https://floating-ui.com/docs/useFocus\n */\nexport function useFocus(context, props = {}) {\n  const {\n    open,\n    onOpenChange,\n    events,\n    dataRef,\n    elements\n  } = context;\n  const {\n    enabled = true,\n    visibleOnly = true\n  } = props;\n  const blockFocusRef = React.useRef(false);\n  const timeout = useTimeout();\n  const keyboardModalityRef = React.useRef(true);\n  React.useEffect(() => {\n    if (!enabled) {\n      return undefined;\n    }\n    const win = getWindow(elements.domReference);\n\n    // If the reference was focused and the user left the tab/window, and the\n    // floating element was not open, the focus should be blocked when they\n    // return to the tab/window.\n    function onBlur() {\n      if (!open && isHTMLElement(elements.domReference) && elements.domReference === activeElement(getDocument(elements.domReference))) {\n        blockFocusRef.current = true;\n      }\n    }\n    function onKeyDown() {\n      keyboardModalityRef.current = true;\n    }\n    function onPointerDown() {\n      keyboardModalityRef.current = false;\n    }\n    win.addEventListener('blur', onBlur);\n    if (isMacSafari) {\n      win.addEventListener('keydown', onKeyDown, true);\n      win.addEventListener('pointerdown', onPointerDown, true);\n    }\n    return () => {\n      win.removeEventListener('blur', onBlur);\n      if (isMacSafari) {\n        win.removeEventListener('keydown', onKeyDown, true);\n        win.removeEventListener('pointerdown', onPointerDown, true);\n      }\n    };\n  }, [elements.domReference, open, enabled]);\n  React.useEffect(() => {\n    if (!enabled) {\n      return undefined;\n    }\n    function onOpenChangeLocal(details) {\n      if (details.reason === 'trigger-press' || details.reason === 'escape-key') {\n        blockFocusRef.current = true;\n      }\n    }\n    events.on('openchange', onOpenChangeLocal);\n    return () => {\n      events.off('openchange', onOpenChangeLocal);\n    };\n  }, [events, enabled]);\n  const reference = React.useMemo(() => ({\n    onMouseLeave() {\n      blockFocusRef.current = false;\n    },\n    onFocus(event) {\n      if (blockFocusRef.current) {\n        return;\n      }\n      const target = getTarget(event.nativeEvent);\n      if (visibleOnly && isElement(target)) {\n        // Safari fails to match `:focus-visible` if focus was initially\n        // outside the document.\n        if (isMacSafari && !event.relatedTarget) {\n          if (!keyboardModalityRef.current && !isTypeableElement(target)) {\n            return;\n          }\n        } else if (!matchesFocusVisible(target)) {\n          return;\n        }\n      }\n      onOpenChange(true, createChangeEventDetails('trigger-focus', event.nativeEvent));\n    },\n    onBlur(event) {\n      blockFocusRef.current = false;\n      const relatedTarget = event.relatedTarget;\n      const nativeEvent = event.nativeEvent;\n\n      // Hit the non-modal focus management portal guard. Focus will be\n      // moved into the floating element immediately after.\n      const movedToFocusGuard = isElement(relatedTarget) && relatedTarget.hasAttribute(createAttribute('focus-guard')) && relatedTarget.getAttribute('data-type') === 'outside';\n\n      // Wait for the window blur listener to fire.\n      timeout.start(0, () => {\n        const activeEl = activeElement(elements.domReference ? elements.domReference.ownerDocument : document);\n\n        // Focus left the page, keep it open.\n        if (!relatedTarget && activeEl === elements.domReference) {\n          return;\n        }\n\n        // When focusing the reference element (e.g. regular click), then\n        // clicking into the floating element, prevent it from hiding.\n        // Note: it must be focusable, e.g. `tabindex=\"-1\"`.\n        // We can not rely on relatedTarget to point to the correct element\n        // as it will only point to the shadow host of the newly focused element\n        // and not the element that actually has received focus if it is located\n        // inside a shadow root.\n        if (contains(dataRef.current.floatingContext?.refs.floating.current, activeEl) || contains(elements.domReference, activeEl) || movedToFocusGuard) {\n          return;\n        }\n        onOpenChange(false, createChangeEventDetails('trigger-focus', nativeEvent));\n      });\n    }\n  }), [dataRef, elements.domReference, onOpenChange, visibleOnly, timeout]);\n  return React.useMemo(() => enabled ? {\n    reference\n  } : {}, [enabled, reference]);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}